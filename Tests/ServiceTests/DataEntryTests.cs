using NUnit.Framework;
using System.Collections.Generic;
using TicketingSystem.Services;
using TicketingSystem.Models;
using System;
using System.Linq;

namespace Prototype.Tests.ServiceTests
{
    [TestFixture]
    public class DataEntryTests
    {
        [Test]
        public void PostEntryTest()
        {
            JobType j = new JobType();
            j.JobType1 = "Miscellaneous";
            TicketData td = new TicketData()
            {
                TripNumber = -1,
                StageNumber = "-1",
                JobType = j,
                EmployeeName = "ServicePostEntryTest",
                StartTime = DateTime.Now,
                Comments = "Entry generated by automated unit test"
            };
            DataEntry de = new DataEntry();
            Assert.IsTrue(de.PostEntry(td));
        }

        [Test]
        public void CloseTicketTest()
        {
            using (var context = new TicketingSystemDBContext())
            {
                JobType j = new JobType()
                {
                    JobType1 = "Miscellaneous"
                };
                //TicketData td = new TicketData()
                //{
                //    Entry
                //    TripNumber = -1,
                //    StageNumber = "-1",
                //    JobType = j,
                //    EmployeeName = "ServicePostEntryTest",
                //    StartTime = DateTime.Now,
                //    Comments = "Entry generated by automated unit test",
                //    IsClosed = true
                //};

                var td = context.TicketData.Where(t => t.EmployeeName == "PostEntryTest").FirstOrDefault();
                DataEntry de = new DataEntry();
                Assert.IsTrue(de.CloseTicket(td));
            }

        }
    }
}
